# üì¶ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü—ã:**
- `production_component_materials` - –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- `materials_catalog` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π)

**ENUM —Ç–∏–ø—ã:**
- `material_type` - —Ç–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞ (–õ–î–°–ü, –ú–î–§, –§–∞–Ω–µ—Ä–∞, –ú–∞—Å—Å–∏–≤, –®–ø–æ–Ω, –ö—Ä–æ–º–∫–∞, –∏ —Ç.–¥.)
- `material_unit` - –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è (–õ–∏—Å—Ç, –º¬≤, –ø.–º, –®—Ç, –∏ —Ç.–¥.)
- `material_finish` - —Ç–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–õ–∞–∫, –ò–Ω—Ü–µ—Å, –ú–∞—Å–ª–æ, –∏ —Ç.–¥.)
- `material_grade` - —Å–æ—Ä—Ç –¥–ª—è —Ñ–∞–Ω–µ—Ä—ã (1/1, 2/2, 4/4, –∏ —Ç.–¥.)

---

## 2. UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç

### `AddMaterialDialog` - —É–º–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –º–µ–±–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**

| –ü–æ–ª–µ | –¢–∏–ø—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|----------------|--------------|
| –ù–∞–∑–≤–∞–Ω–∏–µ | –í—Å–µ | ‚úÖ |
| –¢–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞ | –í—Å–µ | ‚úÖ |
| –¢–æ–ª—â–∏–Ω–∞ (–º–º) | –í—Å–µ | ‚ùå |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –í—Å–µ | ‚úÖ |
| –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è | –í—Å–µ | ‚úÖ |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å | –í—Å–µ | ‚ùå |
| –¶–≤–µ—Ç/–î–µ–∫–æ—Ä | –õ–î–°–ü, –ú–î–§, –ö—Ä–æ–º–∫–∞ | ‚ùå |
| –ü–æ—Ä–æ–¥–∞ –¥–µ—Ä–µ–≤–∞ | –ú–∞—Å—Å–∏–≤, –®–ø–æ–Ω | ‚ùå |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ | –ú–∞—Å—Å–∏–≤, –®–ø–æ–Ω, –§–∞–Ω–µ—Ä–∞ | ‚ùå |
| –°–æ—Ä—Ç | –§–∞–Ω–µ—Ä–∞ | ‚ùå |
| –ê—Ä—Ç–∏–∫—É–ª | –í—Å–µ | ‚ùå |
| –ü—Ä–∏–º–µ—á–∞–Ω–∏—è | –í—Å–µ | ‚ùå |

---

## 3. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –õ–î–°–ü
```typescript
{
  name: "–õ–î–°–ü Egger U999",
  materialType: "ldsp",
  brand: "Egger",
  thickness: 16,
  color: "U999 –ß–µ—Ä–Ω—ã–π",
  quantity: 2,
  unit: "sheet"
}
```

### –ü—Ä–∏–º–µ—Ä 2: –§–∞–Ω–µ—Ä–∞
```typescript
{
  name: "–§–∞–Ω–µ—Ä–∞ –±–µ—Ä–µ–∑–æ–≤–∞—è",
  materialType: "plywood",
  brand: "–°–≤–µ–∑–∞",
  thickness: 12,
  grade: "grade_2_2",  // –°–æ—Ä—Ç 2/2
  finish: "raw",       // –ë–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  quantity: 5,
  unit: "sheet"
}
```

### –ü—Ä–∏–º–µ—Ä 3: –ú–∞—Å—Å–∏–≤ –¥—É–±–∞
```typescript
{
  name: "–ú–∞—Å—Å–∏–≤ –¥—É–±–∞",
  materialType: "solid",
  woodSpecies: "–î—É–±",
  thickness: 40,
  finish: "oil",       // –ú–∞—Å–ª–æ
  quantity: 2.5,
  unit: "sqm"
}
```

### –ü—Ä–∏–º–µ—Ä 4: –ö—Ä–æ–º–∫–∞
```typescript
{
  name: "–ö—Ä–æ–º–∫–∞ ABS",
  materialType: "edge",
  brand: "Rehau",
  thickness: 2,
  color: "–ß–µ—Ä–Ω—ã–π",
  quantity: 15,
  unit: "lm"           // –ø–æ–≥–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä—ã
}
```

---

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º

### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏ SQL —Å–∫—Ä–∏–ø—Ç

```bash
supabase/create-materials-system.sql
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- ENUM —Ç–∏–ø—ã
- –ò–Ω–¥–µ–∫—Å—ã
- –¢—Ä–∏–≥–≥–µ—Ä—ã
- 16 —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ

### –®–∞–≥ 2: –î–æ–±–∞–≤—å —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã

–î–æ–±–∞–≤—å –≤ `ProductionManagementService.ts`:

```typescript
// –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
async addComponentMaterial(componentId: string, materialData: MaterialFormData) {
  const { data, error } = await supabase
    .from('production_component_materials')
    .insert({
      component_id: componentId,
      name: materialData.name,
      material_type: materialData.materialType,
      thickness: materialData.thickness,
      quantity: materialData.quantity,
      unit: materialData.unit,
      color: materialData.color,
      finish: materialData.finish,
      wood_species: materialData.woodSpecies,
      grade: materialData.grade,
      brand: materialData.brand,
      article: materialData.article,
      notes: materialData.notes,
    })
    .select()
    .single();

  if (error) throw error;
  return data;
}

// –ü–æ–ª—É—á–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
async getComponentMaterials(componentId: string) {
  const { data, error } = await supabase
    .from('production_component_materials')
    .select('*')
    .eq('component_id', componentId)
    .order('created_at', { ascending: false });

  if (error) throw error;
  return data;
}

// –£–¥–∞–ª–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
async deleteComponentMaterial(materialId: string) {
  const { error } = await supabase
    .from('production_component_materials')
    .delete()
    .eq('id', materialId);

  if (error) throw error;
}

// –ü–æ–∏—Å–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è)
async searchMaterialsCatalog(query: string, type?: MaterialType) {
  let q = supabase
    .from('materials_catalog')
    .select('*')
    .eq('is_active', true)
    .ilike('name', `%${query}%`)
    .limit(10);

  if (type) {
    q = q.eq('material_type', type);
  }

  const { data, error } = await q;
  if (error) throw error;
  return data;
}
```

### –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `ItemDetailsPanel.tsx`

–í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª":

```typescript
const handleAddMaterial = async (materialData: MaterialFormData) => {
  if (!currentComponent) return;
  
  try {
    await productionManagementService.addComponentMaterial(
      currentComponent.id,
      materialData
    );
    
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    await loadComponentDetails(currentComponent.id);
    
    toast.success('–ú–∞—Ç–µ—Ä–∏–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω');
  } catch (error) {
    console.error('Failed to add material:', error);
    toast.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞');
  }
};
```

---

## 5. Roadmap (–±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è)

### –í –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ:
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- [ ] –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
- [ ] –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è –∑–∞–∫—É–ø–∫–∏
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
- [ ] –£—á–µ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
- [ ] –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- [ ] –ò–º–ø–æ—Ä—Ç –∏–∑ Excel

---

## 6. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### `production_component_materials`

```sql
CREATE TABLE production_component_materials (
  id UUID PRIMARY KEY,
  component_id UUID NOT NULL,     -- ID –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  
  -- –û—Å–Ω–æ–≤–Ω–æ–µ
  name VARCHAR(255) NOT NULL,     -- –ù–∞–∑–≤–∞–Ω–∏–µ
  material_type material_type,    -- –¢–∏–ø (ldsp, mdf, plywood...)
  
  -- –†–∞–∑–º–µ—Ä—ã
  thickness DECIMAL(10,2),        -- –¢–æ–ª—â–∏–Ω–∞ –≤ –º–º
  quantity DECIMAL(10,2),         -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
  unit material_unit,             -- –ï–¥–∏–Ω–∏—Ü–∞ (sheet, sqm, lm...)
  
  -- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
  color VARCHAR(100),             -- –¶–≤–µ—Ç (–¥–ª—è –õ–î–°–ü/–ú–î–§)
  finish material_finish,         -- –û–±—Ä–∞–±–æ—Ç–∫–∞ (–¥–ª—è –º–∞—Å—Å–∏–≤–∞/—à–ø–æ–Ω–∞)
  wood_species VARCHAR(100),      -- –ü–æ—Ä–æ–¥–∞ (–¥–ª—è –º–∞—Å—Å–∏–≤–∞/—à–ø–æ–Ω–∞)
  grade material_grade,           -- –°–æ—Ä—Ç (–¥–ª—è —Ñ–∞–Ω–µ—Ä—ã)
  
  -- –î–æ–ø. –∏–Ω—Ñ–æ
  brand VARCHAR(100),             -- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å
  article VARCHAR(100),           -- –ê—Ä—Ç–∏–∫—É–ª
  notes TEXT,                     -- –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
  
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

---

## 7. FAQ

**Q: –ü–æ—á–µ–º—É —Ç–∞–∫ –º–Ω–æ–≥–æ –ø–æ–ª–µ–π?**
A: –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫. –§–æ—Ä–º–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π —Ç–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞?**
A: –î–∞, –∏—Å–ø–æ–ª—å–∑—É–π —Ç–∏–ø "other" (–ü—Ä–æ—á–µ–µ) –∏–ª–∏ –¥–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Ç–∏–ø –≤ enum —á–µ—Ä–µ–∑ SQL.

**Q: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤?**
A: –≠—Ç–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (—Ñ—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è).

**Q: –ù—É–∂–Ω–æ –ª–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –ø–æ–ª—è?**
A: –ù–µ—Ç, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã —Ç–æ–ª—å–∫–æ: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–ø, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. –û—Å—Ç–∞–ª—å–Ω–æ–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.

---

## 8. –¢–∏–ø—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

| –¢–∏–ø | –ö–æ–¥ | –¢–∏–ø–∏—á–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã | –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–ª—è |
|-----|-----|------------------|------------------|
| –õ–î–°–ü | `ldsp` | –õ–∏—Å—Ç, –º¬≤ | –¶–≤–µ—Ç, –¢–æ–ª—â–∏–Ω–∞ |
| –ú–î–§ | `mdf` | –õ–∏—Å—Ç, –º¬≤ | –¶–≤–µ—Ç, –¢–æ–ª—â–∏–Ω–∞ |
| –§–∞–Ω–µ—Ä–∞ | `plywood` | –õ–∏—Å—Ç, –º¬≤ | –°–æ—Ä—Ç, –¢–æ–ª—â–∏–Ω–∞ |
| –ú–∞—Å—Å–∏–≤ | `solid` | –º¬≤, –ø.–º | –ü–æ—Ä–æ–¥–∞, –û–±—Ä–∞–±–æ—Ç–∫–∞ |
| –®–ø–æ–Ω | `veneer` | –º¬≤ | –ü–æ—Ä–æ–¥–∞, –û–±—Ä–∞–±–æ—Ç–∫–∞ |
| –ö—Ä–æ–º–∫–∞ | `edge` | –ø.–º | –¶–≤–µ—Ç, –¢–æ–ª—â–∏–Ω–∞ |
| –§—É—Ä–Ω–∏—Ç—É—Ä–∞ | `hardware` | –®—Ç, –ö–æ–º–ø–ª–µ–∫—Ç | - |
| –õ–ö–ú | `paint` | –õ, –ö–≥ | - |

---

**–ì–æ—Ç–æ–≤–æ! –°–∏—Å—Ç–µ–º–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.** üéâ

