# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å:

1. –í–∫–ª—é—á–∏–º RLS —Å –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –¥–ª—è authenticated –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (1 –º–∏–Ω—É—Ç–∞)
2. –°–æ–∑–¥–∞–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase Auth (2 –º–∏–Ω—É—Ç—ã)
3. –û–±–Ω–æ–≤–∏–º –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Auth (1 –º–∏–Ω—É—Ç–∞)
4. –ü—Ä–æ–≤–µ—Ä–∏–º –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (1 –º–∏–Ω—É—Ç–∞)

**–ò—Ç–æ–≥–æ: ~5 –º–∏–Ω—É—Ç** ‚è±Ô∏è

---

## –®–ê–ì 1: –í–∫–ª—é—á–µ–Ω–∏–µ RLS —Å Auth –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏

1. –û—Ç–∫—Ä–æ–π **SQL Editor** –≤ Supabase
2. –°–æ–∑–¥–∞–π **New query**
3. –°–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª: `supabase/05-enable-auth.sql`
4. –í—Å—Ç–∞–≤—å –∏ –Ω–∞–∂–º–∏ **RUN**

‚úÖ –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å RLS —Å—Ç–∞—Ç—É—Å–æ–º (–≤—Å–µ üîí –í–∫–ª—é—á–µ–Ω)

---

## –®–ê–ì 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase Auth

1. –í –ø—Ä–æ–µ–∫—Ç–µ –æ—Ç–∫—Ä–æ–π—Ç–µ **Authentication** (—Å–ª–µ–≤–∞ –≤ –º–µ–Ω—é)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Users**
3. –ù–∞–∂–º–∏—Ç–µ **Add user** ‚Üí **Create new user**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Email:** `fominsevil@gmail.com` (–∏–ª–∏ –≤–∞—à email)
   - **Password:** `admin123` (–∏–ª–∏ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å)
   - **Auto Confirm User:** ‚úÖ **–í–ö–õ** (–≤–∞–∂–Ω–æ!)
5. –ù–∞–∂–º–∏—Ç–µ **Create user**

‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω!

---

## –®–ê–ì 3: –°–≤—è–∑—ã–≤–∞–µ–º Auth –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ–π users

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ **User UID** —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `a1b2c3d4-...`)

–¢–µ–ø–µ—Ä—å –≤ **SQL Editor** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –ò–ª—å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ users
UPDATE users 
SET id = '–í–°–¢–ê–í–¨_–°–Æ–î–ê_USER_UID'
WHERE email = 'admin@workshop.ru';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞
SELECT id, name, email, role 
FROM users 
WHERE email = 'admin@workshop.ru';
```

–ó–∞–º–µ–Ω–∏—Ç–µ `–í–°–¢–ê–í–¨_–°–Æ–î–ê_USER_UID` –Ω–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UID!

‚úÖ –¢–µ–ø–µ—Ä—å Auth –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–≤—è–∑–∞–Ω —Å –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º!

---

## –®–ê–ì 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

–ö–æ–¥ —É–∂–µ –≥–æ—Ç–æ–≤! –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä:

```bash
pkill -f vite && npm run dev
```

---

## –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3000
2. –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è **—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞**
3. –í–≤–µ–¥–∏—Ç–µ:
   - **Email:** `fominsevil@gmail.com`
   - **Password:** `admin123`
4. –ù–∞–∂–º–∏—Ç–µ **–í–æ–π—Ç–∏**

‚úÖ **–í–´ –í–û–®–õ–ò!** üéâ

---

## üìù –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ –í—Ö–æ–¥ —Å email/–ø–∞—Ä–æ–ª–µ–º
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ RLS
- ‚úÖ –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥—è—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –∑–∞—â–∏—â–µ–Ω–∞

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–í —Ñ–∞–π–ª–µ `src/lib/supabase/auth-setup.ts` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥:

```typescript
email: 'fominsevil@gmail.com',
password: 'admin123',
```

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å, –ø—Ä–æ—Å—Ç–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏!

---

## üë• –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:

### 1. –°–æ–∑–¥–∞–π—Ç–µ –≤ Authentication:
- Email: `smirnov@workshop.ru`
- Password: `manager123`
- Auto Confirm: ‚úÖ

### 2. –û–±–Ω–æ–≤–∏—Ç–µ –≤ SQL:
```sql
UPDATE users 
SET id = '–Ω–æ–≤—ã–π_user_uid'
WHERE email = 'smirnov@workshop.ru';
```

### 3. –ì–æ—Ç–æ–≤–æ!
–¢–µ–ø–µ—Ä—å –û–ª–µ–≥ –°–º–∏—Ä–Ω–æ–≤ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ —Å–æ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

## üéØ –õ–æ–≥–∏–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Auth –¥–ª—è –≤—Å–µ—Ö:

| –ò–º—è | Email | –†–æ–ª—å |
|-----|-------|------|
| –ò–ª—å—è | `fominsevil@gmail.com` | Admin |
| –û–ª–µ–≥ –°–º–∏—Ä–Ω–æ–≤ | `smirnov@workshop.ru` | Manager |
| –î–º–∏—Ç—Ä–∏–π –ú–∞—Å—Ç–µ—Ä–æ–≤ | `master@workshop.ru` | Master |
| –ï–ª–µ–Ω–∞ –ó–∞–∫—É–ø–∫–∏–Ω–∞ | `procurement@workshop.ru` | Procurement |
| –û–ª—å–≥–∞ –°—á–µ—Ç–æ–≤–∞ | `accountant@workshop.ru` | Accountant |

–í—Å–µ –ø–∞—Ä–æ–ª–∏ –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `admin123`

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

1. **Auto Confirm User** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –í–ö–õ (–∏–Ω–∞—á–µ –Ω—É–∂–Ω–∞ email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)
2. **User UID** –∏–∑ Auth –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å `id` –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
3. RLS –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `auth.uid()` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –≤ Authentication
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Auto Confirm –≤–∫–ª—é—á–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ email/–ø–∞—Ä–æ–ª—å

### –û—à–∏–±–∫–∏ 403 –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∑–∞–ø—É—â–µ–Ω `05-enable-auth.sql`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ User UID —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å id –≤ —Ç–∞–±–ª–∏—Ü–µ users

### –ù–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ:
- –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å –≤ Network ‚Üí Headers
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã (–µ—Å—Ç—å session)

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å:
- üîê –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- üë§ –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞
- üîí Row Level Security
- üìä –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

**Enjoy!** üöÄ

