# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ CRM —Å–∏—Å—Ç–µ–º—ã

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Supabase

–í—ã–ø–æ–ª–Ω–∏ —ç—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã **–ø–æ –ø–æ—Ä—è–¥–∫—É** –≤ Supabase SQL Editor:

### 1Ô∏è‚É£ –û—Ç–∫–ª—é—á–∏—Ç—å RLS (Row Level Security)
**–§–∞–π–ª:** `supabase/disable-all-rls.sql`

–≠—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

```sql
-- –û—Ç–∫–ª—é—á–∞–µ—Ç RLS –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
ALTER TABLE users DISABLE ROW LEVEL SECURITY;
ALTER TABLE clients DISABLE ROW LEVEL SECURITY;
ALTER TABLE projects DISABLE ROW LEVEL SECURITY;
-- –∏ —Ç.–¥.
```

---

### 2Ô∏è‚É£ –û–±–Ω–æ–≤–∏—Ç—å enum –¥–ª—è —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
**–§–∞–π–ª:** `supabase/update-project-stages-enum.sql`

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

```sql
-- –î–æ–±–∞–≤–ª—è–µ—Ç:
-- - preliminary_design
-- - client_approval
-- - tech_approval
-- - quality_check
-- - packaging
-- - delivery
-- - installation
-- - completed
-- - cancelled
```

‚è±Ô∏è **–ü–æ–¥–æ–∂–¥–∏ 1-2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è!**

---

### 3Ô∏è‚É£ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã
**–§–∞–π–ª:** `supabase/update-project-stages-step2.sql`

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

```sql
-- –û–±–Ω–æ–≤–ª—è–µ—Ç:
-- design ‚Üí preliminary_design
-- done ‚Üí completed
```

---

### 4Ô∏è‚É£ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**–§–∞–π–ª:** `supabase/add-test-users.sql`

–î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π.

```sql
-- –î–æ–±–∞–≤–ª—è–µ—Ç 6 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
-- 3 –ú–µ–Ω–µ–¥–∂–µ—Ä–∞
-- 2 –ú–∞—Å—Ç–µ—Ä–∞
-- 1 –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
```

---

### 5Ô∏è‚É£ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
**–§–∞–π–ª:** `supabase/add-test-clients.sql`

–î–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤.

```sql
-- –î–æ–±–∞–≤–ª—è–µ—Ç 5 –∫–ª–∏–µ–Ω—Ç–æ–≤:
-- –§–∏–∑–ª–∏—Ü–æ, –û–û–û, –ò–ü, –°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π, –∏ –µ—â–µ –æ–¥–Ω–æ –û–û–û
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—å:

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```sql
SELECT id, name, email, role, active FROM users;
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 6 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
```sql
SELECT id, name, company, type, phone FROM clients;
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 5 –∫–ª–∏–µ–Ω—Ç–æ–≤.

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ç–∞–ø–æ–≤
```sql
SELECT enumlabel as stage_value 
FROM pg_enum 
WHERE enumtypid = 'project_stage'::regtype 
ORDER BY enumsortorder;
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ —ç—Ç–∞–ø—ã.

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "Column position does not exist"
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `add-test-users.sql` (—É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "Unsafe use of new value"
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏ 1-2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Å–∫—Ä–∏–ø—Ç–æ–≤ 2 –∏ 3

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "Failed to load resource: 403"
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏ —Å–∫—Ä–∏–ø—Ç `disable-all-rls.sql`

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: "–°–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ"
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Supabase –ø—Ä–æ–µ–∫—Ç –∞–∫—Ç–∏–≤–µ–Ω
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

## –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. üîÑ **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (Cmd+R)
2. ‚úÖ –ü–æ–ø—Ä–æ–±—É–π —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ—è–≤–∏–ª–∏—Å—å –≤ —Å–µ–ª–µ–∫—Ç–µ
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —ç—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã users
**–§–∞–π–ª:** `supabase/check-users-structure.sql`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**–§–∞–π–ª:** `supabase/check-users.sql`

---

**–í—Å—ë –≥–æ—Ç–æ–≤–æ!** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. üéâ

